# 비정규화 (반정규화)

## 🐣 비정규화 (반정규화, De-Normalization) ??
:::tip
하나이상의 테이블에 데이터를 중복해 배치하는 최적화 기법  
정규화된 데이터 모델을 통합, 중복, 분리하는 과정으로, `의도적으로 정규화 원칙을 위배시키는 행위`
:::

.

## 🐣 비정규화 장단점??

### 🥚  장점
- 조인비용이 줄어듦 → 데이터 조회속도 향상
- 살펴볼 테이블이 줄어들기 때문에 → 데이터 조회 쿼리가 간단해짐
    - 버그 발생 가능성도 줄어듦
    - 개발 및 운영의 편의성

###### 👾 비정규화를 하면 데이터 조회속도가 향상되는 이유
- 조인비용
- 디스크 조회 비용
    - 디스크, 메모리(M/M), CPU 사이엔 큰 속도와 가격 차이가 있음
        - `디스크` - 큰저장공간과 느림, 장기 기억 저장소
        - `CPU` - 가장빠르고 비쌈(디스크의 약 1만배 이상)
        - `메모리(캐시)` - CPU와 디스크 중간에 자리함 (속도 차이 보완), 단기 기억 저장소, 비쌈
    - 메모리는 한 트랜잭션에서 필요한 데이터를 디스크에서 가져와 CPU 연산작업을 하는 기간동안 저장해놓음
    - → 디스크에서 메모리로 데이터를 가져오는 횟수(부하)를 줄일수록 속도 향상
        - DB는 디스크에 저장됨
    - ⇒ 디스크에서 메모리로 데이터를 가져오는 횟수를 줄이는 것이 반정규화

### 🥚 단점
- 데이터 삽입, 갱신 비용이 큼
- 데이터 간의 무결성이 깨어질 수 있고 → 그럼 어느 쪽이 올바른 값인가? 에 대한 이슈가 생김
- 데이터를 중복하여 저장하므로 더 많은 저장 공간이 필요
- 모델의 유연성이 낮아짐
- 비교적 입력,수정,삭제 쿼리에서 성능이 떨어짐

.

## 🐣 비정규화 권장케이스??
- 일반적으로 조회에 대한 처리 성능이 중요하다고 판단될 때 부분적으로 반정규화 고려
    - 디스크 I/O 량이 많아서 조회 시 성능이 저하되는 경우
    - 테이블끼리의 경로가 너무 멀어 조인으로 인한 성능 저하가 예상되는 경우
    - 칼럼을 계산하여 조회할 때 성능이 저하될 것이 예상되는 경우
- 자주 사용되는 테이블에 액세스하는 프로세스의 수가 가장 많고, 항상 일정한 범위만을 조회하는 경우
- 테이블에 대량 데이터가 있고 대량의 범위를 자주 처리하는 경우, 성능 상 이슈가 있을 경우
- 테이블에 지나치게 조인을 많이 사용하게 되어 데이터를 조회하는 것이 기술적으로 어려울 경우